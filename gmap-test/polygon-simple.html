<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<title>Google Maps JavaScript API v3 Example: Polygon Simple</title>
		<link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script type="text/javascript" src="XH.json"></script>
		<script type="text/javascript" src="http://serverapi.arcgisonline.com/jsapi/arcgis/?v=2.4"></script>
		<script>
			dojo.require("esri.tasks.geometry");

			var dataout;
			function loadData1() {
				var data = [[30.080262, 120.104252], [30.108292, 120.156465], [30.120262, 120.1374252]];
				return data;
			}

			function loadData() {
				// var data = unit.geometry.rings[0];

				var data = [[30.080262, 120.104252], [30.108292, 120.156465], [30.120262, 120.1374252]];

				var gsvc = new esri.tasks.GeometryService("http://220.191.211.111/ArcGIS/rest/services/Geometry/GeometryServer");

				var points = [];
				for(var i = 0; i < data.length; i++) {
					points[i] = new esri.geometry.Point(data[i][0], data[i][1], new esri.SpatialReference({
						wkid : 4326
					}));
					// p.x = p.x + 2182745.19970962362;
					// p.y = p.y + 3410597.07745196516;
				}
				var outSR = new esri.SpatialReference({
					wkid : 4326
				});

				// var out = [];
				gsvc.project(points, outSR, function(projectedPoints) {
					dataout = projectedPoints;
				});
				// document.getElementById("info").innerHTML = points + "; " + gsvc + "; " + str;
				// return out;
			}
		</script>
		<script type="text/javascript">
			function initialize() {
				var myLatLng = new google.maps.LatLng(30.12, 120.13);
				var myOptions = {
					zoom : 12,
					center : myLatLng,
					mapTypeId : google.maps.MapTypeId.ROADMAP
				};

				var bermudaTriangle;

				var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

				// var data = 
				loadData();
				document.getElementById("info").innerHTML = dataout;

				var triangleCoords = [];
				for(var i = 0; i < dataout.length; i++) {
					triangleCoords[i] = new google.maps.LatLng(dataout[i][0], dataout[i][1]);
				}

				// Construct the polygon
				bermudaTriangle = new google.maps.Polygon({
					paths : triangleCoords,
					strokeColor : "#FF0000",
					strokeOpacity : 0.8,
					strokeWeight : 2,
					fillColor : "#FF0000",
					fillOpacity : 0.35
				});

				bermudaTriangle.setMap(map);
			}
		</script>
	</head>
	<body onload="initialize()">
		<div id="map_canvas" style="width: 800px; height: 600px"></div>
		<div id="info"></div>
	</body>
</html>
